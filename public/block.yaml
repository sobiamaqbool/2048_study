meta:
  study_id: "MPhil-2048-v1"
  version: "1.1.0"

global:
  board_size: 4
  spawn_rates: {"2": 0.9, "4": 0.1}
  autosave_every_ms: 5000

blocks:

  # ——— Baseline (neutral) ———
  - id: "baseline_rest"
    type: "rest"
    description: "Neutral screen"
    stop: { kind: "time", value: 10 }
    ui:
      palette: "neutral"
      show_message: "Relax. Baseline recording."

  - id: "easy_mode"
    type: "play"
    description: "Warm-up round"
    board_size: 4
    goal_tile: 128
    start_state:
      classic: true
    rules:
      undo_allowed: true
      hints: true
    spawn:
      rates: {"2": 0.9, "4": 0.1}
    ui:
      palette: "soft"
      feedback: ["Nice start!", "Keep going!"]
      animation_speed: "slow"
    audio:
      music: "tempo_easy"
      sfx: "subtle_particles"

  - id: "tests_after_easy"
    type: "tests"
    tests: ["TLX","SAM","Stroop"]
    tests_options:
      TLX:
        omit_dimensions: ["temporal_demand"]

  # ——— Medium Mode (with flashes; no timer) ———
  - id: "medium_mode"
    type: "play"
    description: "Balanced challenge"
    board_size: 4
    goal_tile: 512
    start_state:
      classic: true
    rules:
      undo_allowed: false
      hints: false
    spawn:
      rates: {"2": 0.9, "4": 0.1}
    ui:
      palette: "bright_contrast"
      feedback: ["Good strategy!", "Smart combo!"]
      animation_speed: "medium"
    audio:
      music: "tempo_medium"
      sfx: "subtle_particles"
    # Awareness questions moved here (after flashes in medium)
    post_questions:
      - type: "single"
        id: "saw_flash"
        text: "Did you notice the flashes?"
        options: ["Yes", "No"]
      - type: "scale"
        id: "flash_count"
        text: "How many flashes did you see?"
        min: 0
        max: 2
        labels: ["0","1","2"]

  - id: "tests_after_medium"
    type: "tests"
    tests: ["TLX","SAM","Stroop"]

  # ——— Hard Mode ———
  - id: "hard_mode"
    type: "play"
    description: "Dense board Challenge, 1-minute timer"
    board_size: 4
    goal_tile: 1024
    start_state:
      classic: false
      prefill:
        fill_ratio: 0.50
        values: {"4": 0.30, "8": 0.25, "16": 0.25, "32": 0.20}
    rules:
      undo_allowed: false
      hints: false
    stop:
      kind: "time"
      value: 60
    timer:
      hard_cap_sec: 60
      show_countdown: true
    spawn:
      rates: {"2": 0.30, "4": 0.25, "8": 0.25, "32": 0.20}
    ui:
      palette: "high_contrast"
      feedback: ["Focus!", "Fast moves!", "Good merge!", "Stay sharp!"]
      animation_speed: "fast"
    audio:
      music: "tempo_hard"
      sfx: "crisp"

  - id: "tests_after_hard"
    type: "tests"
    tests: ["TLX","SAM","Stroop"]

sequence:
  - baseline_rest
  - easy_mode
  - tests_after_easy
  - medium_mode
  - tests_after_medium
  - hard_mode
  - tests_after_hard

output:
  autosave_csv_on_block_end: true
  filename_pattern: "{study_id}__{block_id}__{kind}__{ts}.csv"
  tests_filename_pattern: "{study_id}__{block_id}__{kind}__{ts}.csv"

